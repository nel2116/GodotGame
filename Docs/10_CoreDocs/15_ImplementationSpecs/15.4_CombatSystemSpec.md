---
title: 戦闘システム実装仕様
version: 0.1.0
status: draft
updated: 2025-06-06
tags:
    - Implementation
    - Combat
linked_docs:
    - "[[14.7_CombatSystem.md|戦闘システム]]"
    - "[[14.13_TechnicalDesignSpec.md|技術詳細設計書]]"
---

# 戦闘システム実装仕様

## 目次

1. [概要](#概要)
2. [ユースケース図](#ユースケース図)
3. [状態遷移図](#状態遷移図)
4. [アクティビティ図](#アクティビティ図)
5. [クラス図](#クラス図)
6. [変更履歴](#変更履歴)

## 概要

`HitBox` と `HurtBox` の衝突で `CombatResolver` がダメージ計算を行い、`StatSystem` へ結果を反映する。ヒット演出は別途 `EffectSpawner` が担当する。

## ユースケース図

```mermaid
graph TD
    Player -->|攻撃| HitBox
    Enemy -->|被弾| HurtBox
    HitBox -->|ヒット情報| CombatResolver
    HurtBox --> CombatResolver
    CombatResolver --> StatSystem
```

## 状態遷移図

```mermaid
stateDiagram-v2
    [*] --> Neutral
    Neutral --> Attack : 攻撃入力
    Attack --> Cooldown : ヒット/ミス
    Cooldown --> Neutral : 待機完了
```

## アクティビティ図

```mermaid
flowchart TD
    Start([攻撃発生]) --> Detect[HitBox 接触]
    Detect --> Calc[ダメージ計算]
    Calc --> Apply[StatSystem 適用]
    Apply --> Finish([終了])
```

## クラス図

```mermaid
classDiagram
    class HitBox {
        +emit_hit()
    }
    class HurtBox
    class CombatResolver {
        +resolve(info)
    }
    class StatSystem {
        +apply_damage(result)
    }
    HitBox --> CombatResolver
    HurtBox --> CombatResolver
    CombatResolver --> StatSystem
```

## 変更履歴

| バージョン | 更新日     | 変更内容 |
| ---------- | ---------- | -------- |
| 0.1.0      | 2025-06-06 | 初版作成 |
