---
title: 09_CoreExperienceSpec
version: 0.2
status: draft
updated: 2025-05-29
tags:
    - Document
linked_docs:
---

## 0. 変更履歴

| Ver | 日付       | 概要                             |
| --- | ---------- | -------------------------------- |
| 0.1 | 2025‑05‑29 | 初版                             |
| 0.2 | 2025‑05‑29 | キャンセル表とスタガー仕様を追加 |

## 1. 共通前提

| 項目                  | 値                     | 備考                           |
| --------------------- | ---------------------- | ------------------------------ |
| ターゲット FPS        | **60 fps** (=16.67 ms) | Godot `Engine.target_fps = 60` |
| 入力 → ヒット遅延上限 | **≤ 0.10 s = 6 f**     | 主要 KPI                       |
| 入力バッファ長        | **0.20 s = 12 f**      | 任意入力を `RingBuffer` に保持 |
| ヒットストップ標準    | **0.05 s = 3 f**       | ダメージ種別で ±1F 調整        |
| ダメージ数値単位      | 100 HP = 雑魚平均耐久  | DPS 試算用                     |

## 2. プレイヤーアクション・フレーム表

| アクション       | 総 F | 発生 F | 持続 F | 硬直 F | 無敵 F | 移動距離 | 備考           |
| ---------------- | ---- | ------ | ------ | ------ | ------ | -------- | -------------- |
| **通常攻撃\_L1** | 20   | 4      | 4      | 12     | –      | 0.3 m    | コンボ 1 段目  |
| **通常攻撃\_L2** | 22   | 3      | 5      | 14     | –      | 0.35 m   | コンボ 2 段目  |
| **チャージ攻撃** | 40   | 16     | 6      | 18     | –      | 0.5 m    | 長押し 0.5 s   |
| **回避ロール**   | 26   | 1      | 8      | 17     | 3‑10   | 3 m      | 3‑10F:完全無敵 |
| **ジャンプ**     | 30   | 2      | –      | –      | –      | 4 m(縦)  | 空中制御率 60% |

### 2.2 キャンセル & 入力バッファ表

| アクション元 → | キャンセル可 F | 許可ターゲット          | 備考                         |
| -------------- | -------------- | ----------------------- | ---------------------------- |
| 通常攻撃\_L1   | 14‑20          | 回避 / 攻撃\_L2         | Hit 確認後に回避可能         |
| 通常攻撃\_L2   | 16‑22          | 回避 / チャージ         | 〃                           |
| チャージ攻撃   | 30‑40          | 回避                    | 解除後すぐ次行動             |
| 回避ロール     | 18‑26          | 通常攻撃\_L1 / チャージ | ロール終端で攻撃に繋げられる |
| ジャンプ(空中) | 3‑30           | 空中攻撃 / 回避         | 空中制御中                   |

> **入力バッファ**
>
> -   プレイヤー入力は `InputRing[12]` に保持。
> -   硬直 F 中に検知し次フレームに遷移。
> -   同一フレームに複数有効入力がある場合は優先度: 回避＞ジャンプ＞攻撃。

## 3. ヒットストップ & 演出指針

| 事象            | 停止 F | カメラシェイク  | パーティクル | SE          |
| --------------- | ------ | --------------- | ------------ | ----------- |
| 雑魚 Hit 　　　 | 3      | 0.2 m / 0.08 s  | 火花 8 個    | slash_light |
| 雑魚 Crit       | 4      | 0.3 m / 0.10 s  | 火花 12 個   | slash_heavy |
| ボス部位破壊    | 6      | 0.5 m / 0.15 s  | 爆煙 20 個   | boss_break  |
| プレイヤー被弾  | 2      | 0.25 m / 0.06 s | 血飛沫 6 個  | player_hit  |

### 3.1 スタガー（怯み）システム

-   **Poise**：敵ごとに設定するスタガー耐久値。
-   **スタガーダメージ**：各攻撃に `stagger_value`(例: 通常=10, チャージ=30)。累積が Poise を超えるとスタガー。
-   **スタガー時間**：30F (0.5 s)。この間、敵は移動/攻撃不可。
-   **追加効果**：スタガー中ヒットストップ +4F, 受けるダメージ +25%。
-   **リセット**：スタガー終了時に Poise を全快し、再スタガーまで最短 60F のクールタイム。

| 敵タイプ | Poise | 備考                    |
| -------- | ----- | ----------------------- |
| 近接     | 40    | 通常攻撃 4 発相当       |
| 遠隔     | 30    | 〃                      |
| 突進     | 60    | チャージ 2 発+通常 2 発 |
| サミナー | 25    | 防御低め                |
| ミニボス | 120   | フェーズ毎に-20%        |

> **実装ノート**
>
> -   `poise_current` をリアルタイム減衰(1f +1)させるとソロ周回時の軟化を抑制。
> -   スタガー突入/回復はアニメーションブレンドで繋ぐ。

---

## 4. 敵 AI パラメータ草案

> MVP では **通常敵 4 タイプ＋ミニボス 1 体** を実装する :contentReference[oaicite:2]{index=2}

### 4.1 通常敵テンプレ

| 種別     | HP  | 基本 DPS | 行動一覧 (発生 F/硬直 F/距離)     | 特性               |
| -------- | --- | -------- | --------------------------------- | ------------------ |
| 近接     | 100 | 25       | 斬り(10/18/1m) / 突き(12/16/1.2m) | ガード無           |
| 遠隔     | 80  | 20       | 射撃(14/20/7m) / バックステップ   | 弾速 0.25m/f       |
| 突進     | 120 | 30       | タックル(8/22/4m) / 反転          | タックル中アーマー |
| サミナー | 90  | 10(本体) | 召喚(30/40/–) / 逃走(–/–/3m)      | 雑魚 2 体生成      |

### 4.2 ミニボス例：**影織りの司祭**

| フェーズ  | HP  | 固有行動            | ギミック       |
| --------- | --- | ------------------- | -------------- |
| P1        | 600 | 影弾バースト(12/20) | 設置トラップ   |
| P2 (<50%) | 400 | 影鎌回転(18/24)     | 召喚＋視界縮小 |

---

## 5. KPI との紐付けチェック

-   **入力 → ヒット ≤6F**：キャンセル表により常時保証
-   **スタガー発生頻度**：雑魚 1 体につき平均 1.5 回 / 撃破 を想定し Poise を調整
-   その他 KPI は v0.1 と同様
