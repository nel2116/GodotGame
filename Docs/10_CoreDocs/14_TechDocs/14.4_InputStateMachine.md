---
title: Input State Machine
version: 0.3
status: approved
updated: 2025-06-06
tags:
    - Technical
    - Input
    - State
linked_docs:
    - "[[14.1_Requirement.md]]"
    - "[[14.2_PrototypeTechnicalDesign.md]]"
    - "[[14.3_GodotEnvironment.md]]"
    - "[[14.5_DungeonGeneration.md]]"
    - "[[14.6_EnemyAIFoundation.md]]"
    - "[[14.7_CombatSystem.md]]"
    - "[[14.8_SkillCooldown.md]]"
    - "[[14.9_SaveDataManagement.md]]"
    - "[[14.10_UILayout.md]]"
    - "[[14.11_TestAutomation.md]]"
    - "[[14.12_PerformanceProfiling.md]]"
    - "[[14.13_TechnicalDesignSpec.md]]"
    - "[[14.14_GameManager.md]]"
    - "[[14.15_UIManager.md]]"
    - "[[14.16_SoundManager.md]]"
    - "[[14.17_DebugManager.md]]"
    - "[[14.18_SystemArchitecture.md]]"
    - "[[15.1_ReactiveSystemImpl.md]]"
    - "[[15.2_StateManagementImpl.md]]"
    - "[[15.3_EnemyAISpec.md]]"
    - "[[15.4_CombatSystemSpec.md]]"
    - "[[15.5_SkillSystemSpec.md]]"
    - "[[15.6_SaveLoadSpec.md]]"
    - "[[15.7_UIUXSpec.md]]"
    - "[[15.8_TestPerformanceSpec.md]]"
    - "[[15.12_PerformanceOptimizationSpec.md]]"
---

# 入力状態管理

## 目次

1. [概要](#概要)
2. [システム設計](#システム設計)
3. [状態遷移](#状態遷移)
4. [入力処理](#入力処理)
5. [イベント処理](#イベント処理)
6. [関連ドキュメント](#関連ドキュメント)
7. [変更履歴](#変更履歴)

## 概要

本ドキュメントは、入力状態管理システムの設計を定義する。プレイヤーの入力に基づいて、適切な状態遷移とアクションを制御する。

## システム設計

### 1. アーキテクチャ
- ステートマシンベースの設計
- イベント駆動型の入力処理
- リアクティブな状態管理

### 2. 主要コンポーネント
- 入力マネージャー
- 状態マネージャー
- イベントバス

## 状態遷移

### 1. 基本状態
- アイドル
  - 待機状態
  - 入力待ち
  - アニメーション再生
- 移動
  - 歩行
  - 走行
  - ダッシュ
  - ジャンプ
- 攻撃
  - 通常攻撃
  - 強攻撃
  - 連続攻撃
  - チャージ攻撃
- スキル
  - スキル選択
  - スキル発動
  - クールダウン
- 回避
  - ロール
  - ステップ
  - ガード
- インタラクト
  - 会話
  - アイテム取得
  - ドア開閉

### 2. 遷移条件
- 入力検知
  - キー入力
  - ボタン入力
  - コンボ入力
- 状態完了
  - アニメーション完了
  - アクション完了
  - クールダウン完了
- 外部イベント
  - ダメージ受けた
  - アイテム使用
  - 環境変化
- タイムアウト
  - 入力待ち時間切れ
  - アクション時間切れ
  - バッファ時間切れ

## 入力処理

### 1. 入力タイプ
- キーボード
  - 方向キー
  - アクションキー
  - ファンクションキー
- マウス
  - 左クリック
  - 右クリック
  - ホイール
  - 移動
- ゲームパッド
  - スティック
  - ボタン
  - トリガー
  - バンパー
- タッチ
  - タップ
  - スワイプ
  - ピンチ
  - ロングプレス

### 2. 入力マッピング
- アクション
  - 移動
  - 攻撃
  - スキル
  - インタラクト
- 軸
  - 移動方向
  - カメラ回転
  - 感度調整
- ジェスチャー
  - スワイプ
  - ホールド
  - ドラッグ
- コンボ
  - 連続攻撃
  - スキルチェーン
  - 特殊技

## イベント処理

### 1. イベントタイプ
- 入力イベント
- 状態イベント
- システムイベント
- カスタムイベント

### 2. イベントハンドリング
- イベント発火
- イベント購読
- イベントフィルタリング
- イベントキュー

## 関連ドキュメント

### 技術ドキュメント
- [14.1 要件定義](14.1_Requirement.md) - プロジェクトの要件定義
- [14.2 プロトタイプ技術設計](14.2_PrototypeTechnicalDesign.md) - プロトタイプ開発の技術設計
- [14.3 Godot環境設定](14.3_GodotEnvironment.md) - 開発環境の設定と構成
- [14.5 ダンジョン生成](14.5_DungeonGeneration.md) - ダンジョン生成システムの設計
- [14.6 敵AI基盤](14.6_EnemyAIFoundation.md) - 敵AIシステムの設計
- [14.7 戦闘システム](14.7_CombatSystem.md) - 戦闘システムの設計
- [14.8 スキルクールダウン](14.8_SkillCooldown.md) - スキルクールダウンシステムの設計
- [14.9 セーブデータ管理](14.9_SaveDataManagement.md) - セーブデータ管理システムの設計
- [14.10 UIレイアウト](14.10_UILayout.md) - UIレイアウトシステムの設計
- [14.11 テスト自動化](14.11_TestAutomation.md) - テスト自動化システム
- [14.12 パフォーマンス分析](14.12_PerformanceProfiling.md) - パフォーマンス分析システム
- [14.13 技術設計仕様](14.13_TechnicalDesignSpec.md) - 全体の技術設計仕様
- [14.14 ゲームマネージャー](14.14_GameManager.md) - ゲーム管理システムの設計
- [14.15 UIマネージャー](14.15_UIManager.md) - UI管理システムの設計
- [14.16 サウンドマネージャー](14.16_SoundManager.md) - サウンド管理システムの設計
- [14.17 デバッグマネージャー](14.17_DebugManager.md) - デバッグ管理システムの設計
- [14.18 システムアーキテクチャ](14.18_SystemArchitecture.md) - 全体システムアーキテクチャ

### 実装仕様書
- [15.1 リアクティブシステム実装仕様](15.1_ReactiveSystemImpl.md) - リアクティブシステムの実装詳細
- [15.2 状態管理実装仕様](15.2_StateManagementImpl.md) - 状態管理システムの実装詳細
- [15.3 敵AI実装仕様](15.3_EnemyAISpec.md) - 敵AIシステムの実装詳細
- [15.4 戦闘システム実装仕様](15.4_CombatSystemSpec.md) - 戦闘システムの実装詳細
- [15.5 スキルシステム実装仕様](15.5_SkillSystemSpec.md) - スキルシステムの実装詳細
- [15.6 セーブ・ロード実装仕様](15.6_SaveLoadSpec.md) - セーブ・ロードシステムの実装詳細
- [15.7 UI/UX実装仕様](15.7_UIUXSpec.md) - UI/UXシステムの実装詳細
- [15.8 テスト・パフォーマンス実装仕様](15.8_TestPerformanceSpec.md) - テストとパフォーマンスの実装詳細
- [15.12 パフォーマンス最適化実装仕様](15.12_PerformanceOptimizationSpec.md) - パフォーマンス最適化の実装詳細

## 変更履歴

| バージョン | 更新日     | 変更内容                 |
| ---------- | ---------- | ------------------------ |
| 0.3        | 2025-06-07 | 状態遷移と入力処理を詳細化 |
| 0.2        | 2025-05-29 | テンプレート統一化       |
| 0.1.0      | 2025-05-28 | 初版作成                 |

