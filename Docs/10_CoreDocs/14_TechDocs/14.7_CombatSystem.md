---
title: 戦闘システム
version: 0.1.0
status: draft
updated: 2025-06-06
tags:
    - Technical
    - Prototype
    - Reactive
linked_docs:
    - 14.2_PrototypeTechnicalDesign
---

# 戦闘システム

## 目次

1. [概要](#概要)
2. [詳細](#詳細)
3. [使用方法](#使用方法)
4. [制限事項](#制限事項)
5. [変更履歴](#変更履歴)

## 概要

ヒット判定とダメージ計算をリアクティブに処理する仕組みをまとめる。

## 詳細

- 攻撃判定発生を`Subject`として扱い、命中情報をストリームで通知
- `HitBox`と`HurtBox`を`Area2D`の信号で連携
- ダメージ計算結果を`StatSystem`へ送信し、リアルタイムに体力を更新

## 使用方法

1. 各攻撃アクションで`EmitHit`メソッドを呼び、`IObservable<HitInfo>`を生成
2. 受け手は`Subscribe`してダメージを計算
3. 結果をUIへ流すことで演出との同期を実現

## 制限事項

- 連続ヒット時のデータ量が増えるためバッファ管理が必要
- 複数同時攻撃の競合処理を事前に定義する

## 変更履歴

| バージョン | 更新日     | 変更内容 |
| ---------- | ---------- | -------- |
| 0.1.0      | 2025-06-06 | 初版作成 |

